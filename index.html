<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zakat Calculator</title>

<link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f4f4f4;}
.hero{
height:40vh;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
display:flex;align-items:center;justify-content:center;text-align:center;
}
.ayah{
color:#d4af37;
font-family:'Amiri',serif;
font-size:28px;
padding:20px;
}
.container{
padding:20px;
max-width:800px;
margin:-40px auto 40px;
background:white;
border-radius:12px;
box-shadow:0 5px 20px rgba(0,0,0,0.1);
}
h2{text-align:center;}
input{
width:100%;
padding:10px;
margin:6px 0 12px;
border-radius:6px;
border:1px solid #ccc;
}
.radio-group{
display:flex;
justify-content:center;
gap:20px;
margin-bottom:10px;
}
.result{
margin-top:20px;
padding:15px;
background:#f0f0f0;
border-radius:6px;
font-weight:bold;
white-space:pre-line;
}
.button{
width:100%;
padding:12px;
margin-top:10px;
background:#d4af37;
border:none;
border-radius:6px;
cursor:pointer;
font-weight:bold;
}
.footer{
text-align:center;
margin-top:20px;
font-size:14px;
color:#777;
}
.qr{
width:220px;
display:block;
margin:15px auto;
}
.small{
font-size:12px;
color:#777;
text-align:center;
margin-bottom:10px;
}
hr{
border:none;
border-top:1px solid #ddd;
margin:20px 0;
}
</style>
</head>

<body>

<div class="hero">
<div class="ayah">
وَأَقِيمُوا الصَّلَاةَ وَآتُوا الزَّكَاةَ
</div>
</div>

<div class="container">

<h2>Zakat Calculator (జకాత్ లెక్కింపు సాధనం)</h2>

<div id="hijriDate" class="small"></div>
<div id="rateInfo" class="small"></div>

<label>Optional Name (పేరు – ఐచ్చికం)</label>
<input type="text" id="userName">

<div class="radio-group">
<label><input type="radio" name="nisab" value="silver" checked> Silver Nisab (వెండి)</label>
<label><input type="radio" name="nisab" value="gold"> Gold Nisab (బంగారం)</label>
</div>

<h3>Precious Metals (బంగారం & వెండి)</h3>

<label>Gold (grams)</label>
<input type="number" id="goldGrams">

<label>Gold Price per gram (₹)</label>
<input type="number" id="goldPrice">

<label>Silver (grams)</label>
<input type="number" id="silverGrams">

<label>Silver Price per gram (₹)</label>
<input type="number" id="silverPrice">

<h3>Other Assets (ఇతర ఆస్తులు)</h3>

<label>Cash in Hand (₹)</label>
<input type="number" id="cash">

<label>Bank Balance (₹)</label>
<input type="number" id="bank">

<label>Business Assets (₹)</label>
<input type="number" id="business">

<label>Receivables / Investments (₹)</label>
<input type="number" id="otherAssets">

<h3>Liabilities (బాకీలు)</h3>

<label>Total Liabilities (₹)</label>
<input type="number" id="liability">

<div class="result" id="result"></div>

<button class="button" onclick="downloadPDF()">Download PDF</button>

<hr>

<h3>About Madarsa</h3>
Madarsa Salihaat Lilbanaat Khammam.<br>
20+ girls have completed Nazira Quran.<br>
2 girls have completed 20 para Hifz.<br>
6 girls completed tailoring training.<br>
Basic school education is also provided along with religious education.

<hr>

<b>Support Madarsa:</b><br>
UPI ID: <b>muftiasifali94@okhdfcbank</b>

<img src="donation-qr.png" class="qr">

<a href="upi://pay?pa=muftiasifali94@okhdfcbank&pn=Madarsa%20Donation&cu=INR">
<button class="button">Pay via UPI</button>
</a>

<hr>

<div class="footer">Powered by Noon Enterprises</div>

</div>

<script>

function formatINR(num){
return num.toLocaleString('en-IN',{minimumFractionDigits:2,maximumFractionDigits:2});
}

/* Accurate Hijri Calculation */
function showHijri() {

    const today = new Date();
    const jd = Math.floor((today / 86400000) + 2440587.5);

    const l = jd - 1948440 + 10632;
    const n = Math.floor((l - 1) / 10631);
    let ll = l - 10631 * n + 354;
    const j = (Math.floor((10985 - ll) / 5316)) *
              (Math.floor((50 * ll) / 17719)) +
              (Math.floor(ll / 5670)) *
              (Math.floor((43 * ll) / 15238));
    ll = ll - (Math.floor((30 - j) / 15)) *
         (Math.floor((17719 * j) / 50)) -
         (Math.floor(j / 16)) *
         (Math.floor((15238 * j) / 43)) + 29;

    const month = Math.floor((24 * ll) / 709);
    const day = ll - Math.floor((709 * month) / 24);
    const year = 30 * n + j - 30;

    const months = [
        "Muharram","Safar","Rabi al-Awwal","Rabi al-Thani",
        "Jumada al-Awwal","Jumada al-Thani",
        "Rajab","Sha'ban","Ramadan",
        "Shawwal","Dhul-Qadah","Dhul-Hijjah"
    ];

    document.getElementById("hijriDate").innerText =
        "Hijri Date (Calculated – Global): " +
        day + " " + months[month - 1] + " " + year + " AH";
}
showHijri();

/* Load Rates */
async function loadRates(){
let response=await fetch("rates.json");
let data=await response.json();
goldPrice.value=data.gold;
silverPrice.value=data.silver;
document.getElementById("rateInfo").innerText=
"Rates last updated: "+data.lastUpdated;
}
window.onload=loadRates;

/* Calculation */
function calculateZakat(){
let gG=parseFloat(goldGrams.value)||0;
let gP=parseFloat(goldPrice.value)||0;
let sG=parseFloat(silverGrams.value)||0;
let sP=parseFloat(silverPrice.value)||0;
let cashV=parseFloat(cash.value)||0;
let bankV=parseFloat(bank.value)||0;
let bus=parseFloat(business.value)||0;
let oth=parseFloat(otherAssets.value)||0;
let liab=parseFloat(liability.value)||0;

let goldVal=gG*gP;
let silverVal=sG*sP;
let totalAssets=goldVal+silverVal+cashV+bankV+bus+oth;
let net=totalAssets-liab;

let nisabType=document.querySelector('input[name="nisab"]:checked').value;
let nisab=nisabType==="gold"?87.48*gP:612.36*sP;

if(totalAssets===0&&liab===0){
result.innerText="";
return;
}

let output =
"Total Assets: ₹"+formatINR(totalAssets)+"\n"+
"Total Liabilities: ₹"+formatINR(liab)+"\n"+
"Net Zakatable Wealth: ₹"+formatINR(net)+"\n"+
"Nisab Threshold: ₹"+formatINR(nisab)+"\n\n";

if(net<nisab){
output += "Zakat is NOT obligatory.";
}else{
let zakat=net*0.025;
output += "Zakat Due (2.5%): ₹"+formatINR(zakat);
}

result.innerText=output;
}

document.querySelectorAll("input").forEach(i=>i.addEventListener("input",calculateZakat));
document.querySelectorAll('input[name="nisab"]').forEach(r=>r.addEventListener("change",calculateZakat));

/* PDF */
function downloadPDF(){
const { jsPDF }=window.jspdf;
let doc=new jsPDF();
let name=userName.value;
let today=new Date().toLocaleDateString("en-IN");

doc.setFontSize(16);
doc.text("Zakat Calculation Report",20,20);

doc.setFontSize(12);
let y=35;

if(name){
doc.text("Name: "+name,20,y);
y+=8;
}

doc.text("Date: "+today,20,y);
y+=10;

result.innerText.split("\n").forEach(line=>{
doc.text(line.trim(),20,y);
y+=8;
});

doc.save("Zakat_Report.pdf");
}

</script>

</body>
</html>
