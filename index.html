<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Know Your Zakat Today - జకాత్ లెక్కింపు</title>

<link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f4f4f4;}
.hero{height:32vh;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);display:flex;align-items:center;justify-content:center;text-align:center;}
.ayah{color:#d4af37;font-family:'Amiri',serif;font-size:26px;}
.container{max-width:900px;margin:-40px auto 40px;background:white;padding:20px;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,0.1);}
h2{text-align:center;margin-top:0;}
label{font-weight:bold;}
input{width:100%;padding:8px;margin:6px 0 12px;border-radius:6px;border:1px solid #ccc;}
.section-title{margin-top:25px;font-size:18px;font-weight:bold;}
.result-box{background:#f0f0f0;padding:12px;border-radius:6px;margin-top:10px;white-space:pre-line;font-weight:bold;}
.summary{margin-top:20px;padding:15px;background:#e8f1f7;border-radius:8px;font-weight:bold;}
details{margin-bottom:10px;background:#fafafa;padding:10px;border-radius:6px;}
.button{width:100%;padding:10px;background:#d4af37;border:none;border-radius:6px;cursor:pointer;font-weight:bold;margin-top:10px;}
.small{text-align:center;font-size:12px;color:#777;}
.footer{text-align:center;margin-top:15px;font-size:12px;color:#777;}
hr{margin:25px 0;}
/* NEW: Highlight for TOTAL ZAKAT PAYABLE on page */
#finalSummary .highlight {
  font-size: 28px;
  font-weight: bold;
  text-align: center;
  padding: 15px;
  margin: 15px 0;
  border-radius: 10px;
  background: #fff3e0;
  border: 2px solid #d4af37;
  color: #c62828;
}
#finalSummary .highlight.zero {
  color: #2e7d32;
  background: #e8f5e9;
  border-color: #4caf50;
}
/* Modal styles */
.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.4);
}
.modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
  max-width: 600px;
  border-radius: 10px;
}
.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}
.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="hero">
<div class="ayah">وَأَقِيمُوا الصَّلَاةَ وَآتُوا الزَّكَاةَ</div>
</div>

<div class="container">

<h2>Know Your Zakat Today (జకాత్ లెక్కింపు)</h2>
<div id="hijriDate" class="small"></div>

<label>Optional Name (పేరు)</label>
<input type="text" id="userName">

<div class="section-title">PERSONAL (వ్యక్తిగత)</div>

<label>Gold (grams)</label>
<input type="number" id="goldGrams">

<label>Gold Purity</label>
<select id="goldPurity">
  <option value="1">24K / Pure</option>
  <option value="0.916">22K</option>
  <option value="0.75">18K</option>
</select>

<label>Gold Price</label>
<input type="number" id="goldPrice" value="15649">

<label>Silver (grams)</label>
<input type="number" id="silverGrams">

<label>Silver Price</label>
<input type="number" id="silverPrice" value="270">

<label>Cash</label>
<input type="number" id="personalCash">

<label>Bank Balance</label>
<input type="number" id="personalBank">

<label>Receivables</label>
<input type="number" id="personalReceivables">

<label>Investments / Shares</label>
<input type="number" id="personalInvestments">

<label>Crypto / Digital</label>
<input type="number" id="personalCrypto">

<label>Other Liquid Wealth</label>
<input type="number" id="personalOther">

<label>Total Personal Liabilities (Current Only)</label>
<input type="number" id="personalLiabilities">

<div class="result-box" id="personalResult"></div>

<hr>

<div class="section-title">BUSINESS (వ్యాపారం)</div>

<label>Closing Stock (Sale Value)</label>
<input type="number" id="stock">

<label>Raw Material</label>
<input type="number" id="raw">

<label>Finished Goods</label>
<input type="number" id="finished">

<label>Business Cash</label>
<input type="number" id="bizCash">

<label>Business Bank</label>
<input type="number" id="bizBank">

<label>Customer Receivables</label>
<input type="number" id="bizReceivables">

<label>Business Liabilities (Current Only)</label>
<input type="number" id="bizLiabilities">

<div class="result-box" id="businessResult"></div>

<div class="summary" id="finalSummary"></div>

<div id="nisabInfo" class="nisab-box"></div>

<button class="button" onclick="downloadPDF()">Download Professional PDF</button>

<hr>

<h3 style="text-align:center;cursor:pointer;" onclick="document.getElementById('madarsaModal').style.display='block'">Support Madarsa</h3>
UPI: muftiasifali94@okhdfcbank

<img src="donation-qr.png" style="width:200px;display:block;margin:10px auto;">

<a href="upi://pay?pa=muftiasifali94@okhdfcbank&pn=Zakat&cu=INR">
<button class="button">Pay via UPI</button>
</a>

<div class="footer">Powered by ن Enterprises</div>

</div>

<!-- Madarsa Modal -->
<div id="madarsaModal" style="display:none;position:fixed;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,0.4);">
  <div style="background-color:#fefefe;margin:15% auto;padding:20px;border:1px solid #888;width:80%;max-width:500px;border-radius:10px;">
    <span style="color:#aaa;float:right;font-size:28px;font-weight:bold;cursor:pointer;" onclick="document.getElementById('madarsaModal').style.display='none'">&times;</span>
    <h2 style="text-align:center;color:#006400;">మదరసా సాలిహాత్ లిల్బనాత్ ఖమ్మం</h2>
    <p style="text-align:center;font-weight:bold;">Appeal for Taawun 2026</p>
    <p><strong>ఒక లడ్కీ కి మంత్లీ కఫాలత్:</strong> ₹1800/-</p>
    <p>అల్హమ్దులిల్లాహ్, 20 లడ్కియోం నే నజీరా ఖురాన్ ఔర్ దీన్ కి బున్యాదీ మలూమాత్ కా ఇల్మ్ హాసిల్ కియా.</p>
    <p>6 బచ్చియోం నే టైలరింగ్ ముకమ్మల్ కియా. హిఫ్జ్ & ఆలిమియత్ జారీ హై.</p>
    <p>ఆప్ జకాత్, సదకా, ఫిత్రా, అతియా సే మదద్ ఫర్మా సక్తే హైం.</p>
    <hr>
    <p><strong>Bank Details:</strong></p>
    <p>Account No: 1200000485740</p>
    <p>IFSC: CNRB0008484</p>
    <p>Name: Asif Ali Sayeed Qasmi</p>
    <p>Phone: 95022 55318</p>
    <p>UPI: muftiasifali94@okhdfcbank</p>
  </div>
</div>

<script>

function formatINR(num){
return num.toLocaleString('en-IN',{minimumFractionDigits:2,maximumFractionDigits:2});
}

function showHijri(){
const today=new Date();
const jd=Math.floor((today/86400000)+2440587.5);
const l=jd-1948440+10632;
const n=Math.floor((l-1)/10631);
let ll=l-10631*n+354;
const j=(Math.floor((10985-ll)/5316))*(Math.floor((50*ll)/17719))
+(Math.floor(ll/5670))*(Math.floor((43*ll)/15238));
ll=ll-(Math.floor((30-j)/15))*(Math.floor((17719*j)/50))
-(Math.floor(j/16))*(Math.floor((15238*j)/43))+29;
const month=Math.floor((24*ll)/709);
const day=ll-Math.floor((709*month)/24);
const year=30*n+j-30;
const months=["Muharram","Safar","Rabi al-Awwal","Rabi al-Thani",
"Jumada al-Awwal","Jumada al-Thani","Rajab","Sha'ban","Ramadan",
"Shawwal","Dhul-Qadah","Dhul-Hijjah"];
document.getElementById("hijriDate").innerText=
"Hijri Date (Global): "+day+" "+months[month-1]+" "+year+" AH";
}
showHijri();

function calculate(){

let goldVal=(+goldGrams.value||0)*(+goldPrice.value||0)*(+goldPurity.value||1);
let silverVal=(+silverGrams.value||0)*(+silverPrice.value||0);

let personalAssets=
goldVal+silverVal+
(+personalCash.value||0)+
(+personalBank.value||0)+
(+personalReceivables.value||0)+
(+personalInvestments.value||0)+
(+personalCrypto.value||0)+
(+personalOther.value||0);

let personalLiab=(+personalLiabilities.value||0);
let personalNet=personalAssets-personalLiab;
let personalZakat=personalNet>0?personalNet/40:0;

personalResult.innerText=
"Total Personal Assets: ₹"+formatINR(personalAssets)+
"\nPersonal Liabilities: ₹"+formatINR(personalLiab)+
"\nPersonal Net: ₹"+formatINR(personalNet)+
"\nZakat portion: ₹"+formatINR(personalZakat);

let bizAssets=
(+stock.value||0)+
(+raw.value||0)+
(+finished.value||0)+
(+bizCash.value||0)+
(+bizBank.value||0)+
(+bizReceivables.value||0);

let bizLiab=(+bizLiabilities.value||0);
let bizNet=bizAssets-bizLiab;
let bizZakat=bizNet>0?bizNet/40:0;

businessResult.innerText=
"Total Business Assets: ₹"+formatINR(bizAssets)+
"\nBusiness Liabilities: ₹"+formatINR(bizLiab)+
"\nBusiness Net: ₹"+formatINR(bizNet)+
"\nZakat portion: ₹"+formatINR(bizZakat);

let totalZakat=personalZakat+bizZakat;

let nisabSilver = 612.36 * (+silverPrice.value || 270);
let nisabGold   = 87.48 * (+goldPrice.value || 15738);
let nisabThreshold = nisabSilver; // Silver-based

let statusMessage = totalNetWealth >= nisabThreshold ?
  "✅ Meets/exceeds Nisab → Zakat is due (if held for 1 Hijri year)" :
  "❌ Below Nisab → No Zakat due currently";

document.getElementById("finalSummary").innerHTML =
  `<div class="highlight-zakat ${totalZakat > 0 ? '' : 'zero'}">
     <div class="amount">TOTAL ZAKAT PAYABLE: ₹${formatINR(totalZakat)}</div>
     <div class="status">${statusMessage}</div>
   </div>`;

document.getElementById("nisabInfo").innerHTML =
  `Nisab (silver basis): \~ ₹${formatINR(nisabSilver)} (612.36g)<br>` +
  `Nisab (gold basis): \~ ₹${formatINR(nisabGold)} (87.48g)<br>` +
  `<strong>Your total net wealth: ₹${formatINR(personalNet + bizNet)}</strong>`;
}

document.querySelectorAll("input, select").forEach(i=>i.addEventListener("input",calculate));

function downloadPDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  let y = 20;

  doc.setFontSize(18);
  doc.setTextColor(212, 175, 55);
  doc.text("Zakat Calculation Report", 105, y, {align: "center"});
  y += 12;

  doc.setFontSize(11);
  doc.setTextColor(0);
  doc.text("Name: " + (userName.value || "N/A"), 20, y);
  doc.text("Date: " + new Date().toLocaleDateString('en-IN'), 150, y);
  y += 8;

  doc.text(document.getElementById("hijriDate").innerText, 20, y);
  y += 12;

  // Highlighted Zakat Payable in PDF
  doc.setFontSize(16);
  doc.setTextColor(totalZakat > 0 ? 220 : 46, totalZakat > 0 ? 53 : 125, totalZakat > 0 ? 69 : 50);
  doc.setFillColor(totalZakat > 0 ? 255 : 232, totalZakat > 0 ? 235 : 245, totalZakat > 0 ? 238 : 233);
  doc.rect(15, y - 5, 180, 18, 'F');
  doc.text(`TOTAL ZAKAT PAYABLE: ₹${formatINR(totalZakat)}`, 105, y + 6, {align: "center"});
  y += 25;

  doc.setFontSize(12);
  doc.setTextColor(0);
  doc.text(statusMessage, 105, y, {align: "center"});
  y += 15;

  doc.setFontSize(12);
  doc.text("Personal Section", 20, y);
  y += 8;

  doc.autoTable({
    startY: y,
    head: [['Item', 'Value (₹)']],
    body: [
      ['Gold Value', formatINR((+goldGrams.value||0)*(+goldPrice.value||0)*(+goldPurity.value||1))],
      ['Silver Value', formatINR((+silverGrams.value||0)*(+silverPrice.value||0))],
      ['Cash', formatINR(+personalCash.value||0)],
      ['Bank Balance', formatINR(+personalBank.value||0)],
      ['Receivables', formatINR(+personalReceivables.value||0)],
      ['Investments / Shares', formatINR(+personalInvestments.value||0)],
      ['Crypto / Digital', formatINR(+personalCrypto.value||0)],
      ['Other Liquid Wealth', formatINR(+personalOther.value||0)],
      ['Total Personal Assets', formatINR(personalAssets)],
      ['Personal Liabilities', formatINR(personalLiab)],
      ['Personal Net', formatINR(personalNet)],
      ['Zakat (2.5%)', formatINR(personalZakat)]
    ],
    margin: {left: 20},
    theme: 'grid'
  });
  y = doc.lastAutoTable.finalY + 10;

  doc.setFontSize(12);
  doc.text("Business Section", 20, y);
  y += 8;

  doc.autoTable({
    startY: y,
    head: [['Item', 'Value (₹)']],
    body: [
      ['Closing Stock', formatINR(+stock.value||0)],
      ['Raw Material', formatINR(+raw.value||0)],
      ['Finished Goods', formatINR(+finished.value||0)],
      ['Business Cash', formatINR(+bizCash.value||0)],
      ['Business Bank', formatINR(+bizBank.value||0)],
      ['Customer Receivables', formatINR(+bizReceivables.value||0)],
      ['Total Business Assets', formatINR(bizAssets)],
      ['Business Liabilities', formatINR(bizLiab)],
      ['Business Net', formatINR(bizNet)],
      ['Zakat (2.5%)', formatINR(bizZakat)]
    ],
    margin: {left: 20},
    theme: 'grid'
  });
  y = doc.lastAutoTable.finalY + 10;

  doc.setFontSize(12);
  doc.text("Nisab Information", 20, y);
  y += 8;
  let nisabLines = document.getElementById("nisabInfo").innerText.split("\n");
  nisabLines.forEach(line => { doc.text(line, 20, y); y += 7; });
  y += 10;

  doc.setFontSize(10);
  doc.setTextColor(100);
  doc.text("Note: Zakat @ 2.5% on net qualifying wealth (after current liabilities).", 20, y);
  y += 7;
  doc.text("Consult a scholar for specific rulings.", 20, y);
  y += 7;
  doc.text("Support Madarsa Salihaat Lilbanaat Khamammam", 105, y, {align:"center"});
  y += 10;
  doc.setFontSize(10);
  doc.text("Monthly Kafalat: ₹1800/-", 20, y); y += 7;
  doc.text("20 girls completed Nazira Quran & basic Deen knowledge.", 20, y); y += 7;
  doc.text("6 girls completed tailoring training.", 20, y); y += 7;
  doc.text("Hifz & Aalimiyat ongoing.", 20, y); y += 7;
  doc.text("Bank A/c: 1200000485740 | IFSC: CNRB0008484", 20, y); y += 7;
  doc.text("UPI: muftiasifali94@okhdfcbank", 20, y);

  doc.save("Zakat_Report.pdf");
}

document.querySelectorAll("input, select").forEach(i=>i.addEventListener("input",calculate));

window.onload = function() {
  calculate();
};

</script>

</body>
</html>
