<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zakat Calculator</title>

<link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f4f4f4;}
.hero{
height:45vh;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
display:flex;align-items:center;justify-content:center;text-align:center;
}
.ayah{color:#d4af37;font-family:'Amiri',serif;font-size:28px;padding:20px;}
.container{
padding:20px;max-width:800px;margin:-40px auto 40px;
background:white;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,0.1);
}
h2{text-align:center;}
.section-title{margin-top:20px;font-weight:bold;}
input{
width:100%;padding:10px;margin:6px 0 12px;
border-radius:6px;border:1px solid #ccc;
}
.radio-group{display:flex;justify-content:center;gap:20px;margin-bottom:10px;}
.result{
margin-top:20px;padding:15px;background:#f0f0f0;
border-radius:6px;font-weight:bold;white-space:pre-line;
}
.button{
width:100%;padding:12px;margin-top:10px;
background:#d4af37;border:none;border-radius:6px;
cursor:pointer;font-weight:bold;
}
.footer{text-align:center;margin-top:20px;font-size:14px;color:#777;}
.tooltip{
display:none;background:#fff8e1;padding:10px;border-radius:6px;
margin-bottom:10px;font-size:13px;border:1px solid #e0c97f;
}
.qr{width:230px;display:block;margin:15px auto;}
.small{font-size:12px;color:#777;text-align:center;margin-bottom:10px;}
hr{border:none;border-top:1px solid #ddd;}
</style>
</head>

<body>

<div class="hero">
<div class="ayah">وَأَقِيمُوا الصَّلَاةَ وَآتُوا الزَّكَاةَ</div>
</div>

<div class="container">

<h2>Zakat Calculator (జకాత్ లెక్కింపు సాధనం)</h2>

<div id="hijriDate" class="small"></div>
<div id="rateInfo" class="small"></div>

<label>Optional Name (పేరు – ఐచ్చికం)</label>
<input type="text" id="userName">

<div class="radio-group">
<label><input type="radio" name="nisab" value="silver" checked> Silver Nisab</label>
<label><input type="radio" name="nisab" value="gold"> Gold Nisab</label>
</div>

<div class="section-title">Precious Metals</div>

<label>Gold (grams)</label>
<input type="number" id="goldGrams">

<label>Gold Price per gram (₹)</label>
<input type="number" id="goldPrice">

<label>Silver (grams)</label>
<input type="number" id="silverGrams">

<label>Silver Price per gram (₹)</label>
<input type="number" id="silverPrice">

<div class="section-title">Other Assets</div>

<label>Cash in Hand (₹)</label>
<input type="number" id="cash">

<label>Bank Balance (₹)</label>
<input type="number" id="bank">

<label>Business Assets (₹)</label>
<input type="number" id="business">

<label>Receivables / Investments (₹)</label>
<input type="number" id="otherAssets">

<div class="section-title">Liabilities</div>

<label>Total Liabilities (₹)</label>
<input type="number" id="liability">

<div class="result" id="result"></div>

<button class="button" onclick="downloadPDF()">Download PDF</button>

<hr>

<b>Support Madarsa:</b><br>
UPI ID: <b>muftiasifali94@okhdfcbank</b>

<img src="donation-qr.png" class="qr">

<hr>

<div class="footer">Powered by Noon Enterprises</div>

</div>

<script>

function formatINR(num){
return num.toLocaleString('en-IN',{minimumFractionDigits:2,maximumFractionDigits:2});
}

async function loadRates(){
try{
let response = await fetch("rates.json");
let data = await response.json();

goldPrice.value = data.gold;
silverPrice.value = data.silver;

document.getElementById("rateInfo").innerText =
"Rates last updated: " + data.lastUpdated;

calculateZakat();

}catch(e){
document.getElementById("rateInfo").innerText =
"Unable to load live rates.";
}
}

function calculateZakat(){
let gG=parseFloat(goldGrams.value)||0;
let gP=parseFloat(goldPrice.value)||0;
let sG=parseFloat(silverGrams.value)||0;
let sP=parseFloat(silverPrice.value)||0;
let cashV=parseFloat(cash.value)||0;
let bankV=parseFloat(bank.value)||0;
let bus=parseFloat(business.value)||0;
let oth=parseFloat(otherAssets.value)||0;
let liab=parseFloat(liability.value)||0;

let goldVal=gG*gP;
let silverVal=sG*sP;
let totalAssets=goldVal+silverVal+cashV+bankV+bus+oth;
let net=totalAssets-liab;

let nisabType=document.querySelector('input[name="nisab"]:checked').value;
let nisab=nisabType==="gold"?87.48*gP:612.36*sP;

if(totalAssets===0&&liab===0){
result.innerText="";
return;
}

let output =
"Total Assets: ₹"+formatINR(totalAssets)+"\n"+
"Total Liabilities: ₹"+formatINR(liab)+"\n"+
"Net Zakatable Wealth: ₹"+formatINR(net)+"\n"+
"Nisab Threshold: ₹"+formatINR(nisab)+"\n\n";

if(net<nisab){
output += "Zakat is NOT obligatory.";
}else{
let zakat=net*0.025;
output += "Zakat Due (2.5%): ₹"+formatINR(zakat);
}

result.innerText=output;
}

document.querySelectorAll("input").forEach(i=>i.addEventListener("input",calculateZakat));
document.querySelectorAll('input[name="nisab"]').forEach(r=>r.addEventListener("change",calculateZakat));

async function showHijri(){
try{
const today=new Date();
const response=await fetch(`https://api.aladhan.com/v1/gToH?date=${today.getDate()}-${today.getMonth()+1}-${today.getFullYear()}`);
const data=await response.json();
const h=data.data.hijri;
document.getElementById("hijriDate").innerText =
"Hijri Date (Global): "+h.day+" "+h.month.en+" "+h.year+" AH";
}catch(e){}
}
showHijri();

function downloadPDF(){
const { jsPDF }=window.jspdf;
let doc=new jsPDF();
let name=userName.value;
let today=new Date().toLocaleDateString("en-IN");

doc.setFontSize(16);
doc.text("Zakat Calculation Report",20,20);

doc.setFontSize(12);
let y=35;

if(name){
doc.text("Name: "+name,20,y);
y+=8;
}

doc.text("Date: "+today,20,y);
y+=12;

let lines=result.innerText.split("\n");
lines.forEach(line=>{
doc.text(line.trim(),20,y);
y+=8;
});

doc.save("Zakat_Report.pdf");
}

window.onload=loadRates;

</script>

</body>
</html>
